clc, clear;
d=[0	0	0.01	  0.0013	0.00025
0.0005	0.0025	0.02	0.0025	0.0005
0.002	0.01	0.04	0.05	0.001
0.003	0.015	0.06	0.075	0.0015
0.004	0.02	0.08	0.1	    0.002];
c=mean(d) 
b=[0.0019,0.0004,0.004,0.004,0];
M11=@(x)(x==0)-2000*(x-0.0005).*(x>0 & x<0.0005);
M12=@(x)2000*x.*(x>0 & x<0.0005)+(x==0.0005)-...
666.67*(x-0.002).*(x>0.0005 & x<0.002);
M13=@(x)666.67*(x-0.0005).*(x>0.0005 & x<0.002)+(x==0.002)-...
1000*(x-0.003).*(x>0.002 & x<0.003);
M14=@(x)1000*(x-0.002).*(x>0.002 & x<0.003)+(x==0.003)-...
1000*(x-0.004).*(x>0.003 & x<0.004);
M15=@(x)1000*(x-0.003).*(x>0.003 & x<0.004)+(x>=0.004);
F1=[M11(0.0019),M12(0.0019),M13(0.0019),M14(0.0019),M15(0.0019)]
t=b./c; 
w=t/sum(t) 
R=zeros(5); R(1,:)=F1; R([3:5])=1; R([2,7])=[0.84,0.16] 
A=max(min(repmat(w,size(R,2),1)',R)) 